
# ApiExpress

Содержание:

[Введение](#introduction)

[Флоу работы сервера](#flow)

[Предварительные требования](#requirements)

[Запуск](#start)

[Использование adminer](#adminer)

[Использование pgAdmin](#pgAdmin)
 
## <a name="introduction">Введение</a> 
apiExpress — это серверное приложение на NodeJS, которое запрашивает данные в PostgreSQL базе, кеширует в памяти приложения, в Redis и отдает клиенту 
с использованием TypeScript, PostgreSQL, Redis, express, typeOrm, Docker, с наличием базовой функциональности, а также 
с такими инструментами разработки для PostgreSQL и связанных с ней систем управления базами данных как Adminer и pgAdmin.
В приложении уже создана и заполнена данными база PostgreSQL.

Тестовые данные для заполнения базы были взяты [отсюда](https://www.postgresqltutorial.com/postgresql-sample-database):

## <a name="flow">Флоу работы сервера состоит в следующем:</a>
1. Клиент запрашивает данные.
2. Сервер проверяет, есть ли данные в памяти Node приложения.
3. Если есть в Node - отдает. Если нет, проверяет в Redis store.
4. Если есть в Redis - отдает. Если нет, делает запрос к базе данных.
5. Возвращает данные клиенту. Обновляет Redis и Node кеш


## <a name="requirements">Предварительные требования</a>
Фактически, достаточно скопировать этот проект и заменить некоторые настройки, руководствуясь комментариями ниже.
Перед использованием убедитесь, что у вас установлены docker-compose и Node.js.
Также необходимо наличие файла .env В проекте уже находится файл .env.example просто переименуйте его в .env
В дальнейшем вы сможете изменить в нем настройки по своему усмотрению.
Итак:
1. Скачайте и распакуйте проект;
2. Откройте терминал и перейдите в каталог где находится проект, например *cd apiExpress*;
3. Установите необходимые пакеты выполнив *npm install*

## <a name="start">Запуск</a>
В терминале, находясь в каталоге проекта выполните следующие команды:
- *docker-compose up -d*
- *npm run prestart:prod*
- *npm run start*
- Или после запуска контейнера можно запустить в режиме разработки выполнив npm run dev

## <a name="start">Использование</a> 
- Откройте браузер и введите http://localhost:3000/film/id/5
- http://localhost:3000/film/id/может быть в диапазоне от 1 до 1000
- Скопируйте текст title и перейдите по http://localhost:3000/film/скопированный текст
- Или просто откройте в браузере http://localhost:3000/film/Zorro%20Ark

*Обновляя страницу в левом верхнем углу вы заметите иизменение текста.*
Данный текст информирует о том, где были взяты данные для представления, так:
- the data from the cache database was not used - данные были взяты из базы
- Node-cashe данные взяты из кеша Node
- Redis-cashe данные взяты из кеша Redis

## <a name="adminer">Использование Adminer</a> 
Adminer открывается на 8090 порту, по адресу http://localhost:8090

_Учетные данные:_
- System: PostgreSQL
- Server: db
- Username: root	
- Password: root	
- Database: dvdrental	

## <a name="pgAdmin">Использование pgAdmin</a> 
pgAdmin открывается на 8090 порту, по адресу http://localhost:5050

_Учетные данные:_
- Email Adress: admin@admin.com
- Password:  root





